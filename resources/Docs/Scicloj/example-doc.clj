[{:editor {:label "ClJS", :opts {:order :row, :eltsper 1, :size "auto", :wrapfn {:tid :editor, :fn [quote editor-repl-tab], :layout :left-right, :ns aerial.saite.usercode, :width "730px", :src "(map inc (range 20))", :out-height "700px", :eid "ed-editor", :height "700px"}}, :specs []}} {:chap1 {:label "Chapter 1", :opts {:order :row, :eltsper 1, :size "auto", :wrapfn {:tid :chap1, :$split 33, :fn [quote interactive-doc-tab], :ns aerial.saite.usercode, :width "730px", :src "\n12345678901234567890123456789012345678901234567890123456789012345678901234567890\n;; Add some page/section title text\n(hc/xform\n ht/empty-chart :FID :dtitle\n :TOP '[[gap :size \"50px\"]\n        [md\n\"# Example Interactive Document Creation\n![img](http://localhost:3000/Himeji_sakura.jpg \\\"Himeji\\\")\"]])\n\n\n;; Render a graphic in it\n(hc/xform\n ht/bar-chart\n :TITLE \"Top headline phrases\"\n :TOP '[[md \"### Simple barchart with in line data\"]]\n :TID :chap1 :FID :dhline\n :X :x-value :Y :y-value :YTYPE \"nominal\"\n :DATA\n [{:x-value 8961 :y-value \"will make you\"}\n  {:x-value 4099 :y-value \"this is why\"}\n  { :x-value 3199 :y-value \"can we guess\"}\n  {:x-value 2398 :y-value \"only X in\"}\n  {:x-value 1610 :y-value \"the reason is\"}\n  {:x-value 1560 :y-value \"are freaking out\"}\n  {:x-value 1425 :y-value \"X stunning photos\"}\n  {:x-value 1388 :y-value \"tears of joy\"}\n  {:x-value 1337 :y-value \"is what happens\"}\n  {:x-value 1287 :y-value \"make you cry\"}])\n\n\n;; Add empty picture frame with all elements as MD\n(hc/xform\n ht/empty-chart :FID :dwrup1\n :TOP '[[gap :size \"200px\"] [md \"# Header top\"]]\n :BOTTOM '[[gap :size \"200px\"] [md \"# Header bottom\"]]\n :LEFT '[[gap :size \"50px\"] [md \"### Header left\"]]\n :RIGHT '[[md \"### Header right\"]])\n\n\n\n\n(def animal-data\n  [{:animal \"Cheetah\", :kph 120}\n   {:animal \"Domestic Cat\", :kph 48}\n   {:animal \"Elephant\", :kph 40}\n   {:animal \"Giraffe\", :kph 52}\n   {:animal \"Horse\", :kph 88}\n   {:animal \"Ostrich\", :kph 70}\n   {:animal \"Pig\", :kph 17.7}\n   {:animal \"Polar Bear\", :kph 30}\n   {:animal \"Rabbit\", :kph 48}\n   {:animal \"Squirrel\", :kph 20}])\n\n(hc/xform\n ht/bar-chart\n :FID :danimals :VID :animals\n :TITLE \"Top speeds as scatter plot\"\n :TRANSFORM [{:calculate \"datum.kph*0.62137\", :as \"mph\"}]\n :X \"mph\" :XTITLE \"Speed (mph)\"\n :Y \"animal\" :YTYPE \"nominal\" :YTITLE nil\n :YSORT {:field \"mph\", :op \"average\", :order \"descending\"}\n :TOOLTIP [:YTTIP :XTTIP]\n :YTTITLE \"Animal\" :XTTITLE \"Speed\" :XTFMT \".1f\"\n :COLOR {:value \"#fc6721\"} :OPACITY {:value 0.7}\n :DATA animal-data)\n\n\n\n\n;; Make some distribution data\n(def obsdist\n  (let [obs [[0 9] [1 78] [2 305] [3 752] [4 1150] [5 1166]\n             [6 899] [7 460] [8 644] [9 533] [10 504]]\n        totcnt (->> obs (mapv second) (apply +))\n        pdist (map (fn[[k cnt]] [k (double (/ cnt totcnt))]) obs)]\n    pdist))\n\n\n;; Add a distribution chart to the tab\n(hc/xform\n ht/layer-chart\n :TID :chap1 :FID :dex1\n :TITLE \"A Real (obvserved) distribution with incorrect simple mean\"\n :HEIGHT 400 :WIDTH 450\n :LAYER\n [(hc/xform ht/bar-layer :XTITLE \"Count\" :YTITLE \"Probability\")\n  (hc/xform ht/xrule-layer :AGG \"mean\")]\n :DATA (mapv (fn[[x y]] {:x x :y y :m 5.7}) obsdist))\n\n\n;; Add some 'writeup'\n(hc/xform\n ht/empty-chart :FID :dwrup2\n :TOP '[[gap :size \"50px\"]\n        [md\n\"# Fixed distribution\nHere we have corrected the mean by properly including item weights\"]])\n\n\n(hc/xform\n ht/layer-chart\n :TID :chap1 :FID :dex2\n :TITLE \"The same distribution with correct weighted mean\"\n :HEIGHT 400 :WIDTH 450\n :LAYER\n [(hc/xform ht/bar-layer :XTITLE \"Count\" :YTITLE \"Probability\")\n  (hc/xform ht/xrule-layer :X \"m\")]\n :DATA (mapv (fn[[x y]] {:x x :y y :m 5.7}) obsdist))\n\n\n(defn update-frame [tid fid element content]\n  (hmi/update-frame tid fid element content)\n  (aerial.saite.core/mathjax-put fid))\n\n(update-frame\n  :chap1 :dwrup1\n  :bottom [[h-box\n           :children\n           [[gap :size \"50px\"]\n            #_[md \"* title\"]\n            #_[p \"some text\"]\n            [md {:style {:font-size \"20px\" :color \"blue\"}}\n\"\n  * P(x) = \\\\(\\\\frac{1}{\\\\sqrt{2\\\\pi \\\\sigma^2}} e^{- \\\\frac{(x - \\\\mu)^2}{2\\\\sigma ^2}}\\\\)\n\n  * \\\\(f(x) = x^2\\\\)\n\n  * \\\\(g(x) = \\\\sqrt x + \\\\pi\\\\)\"]]]])\n\n;;;  * ![img](https://raw.githubusercontent.com/jsa-aerial/hanami/master/resources/public/Small-Himeji_sakura.png \\\"\\\")\n", :out-height "100px", :eid "ed-chap1", :height "700px"}}, :specs [{:usermeta {:frame {:top [[gap :size "50px"] [md "# Example Interactive Document Creation\n![img](http://localhost:3000/Himeji_sakura.jpg \"Himeji\")"]], :fid :dtitle}, :session-name "Exploring", :opts {:mode "vega-lite", :source false, :export {:png true, :svg true}, :renderer "canvas", :scaleFactor 1, :editor true}, :msgop :tabs, :tab {:label "Expl1", :id :expl1, :opts {:eltsper 2, :size "auto", :order :row}}}}]}} {:expl1 {:label "Expl1", :opts {:eltsper 2, :size "auto", :order :row}, :specs [{:encoding {:y {:field "b", :type "quantitative", :axis {:title "Bar"}}, :x {:field "a", :type "ordinal", :axis {:title "Foo"}}, :tooltip [{:field "a", :type "ordinal"} {:field "b", :type "quantitative"}]}, :usermeta {:frame {:bottom [[gap :size "50px"] [v-box :children [[p "some text to test, default 14px"] [p {:style {:font-size "16px"}} "some tex \\(f(x) = x^2\\), 16px"] [p {:style {:font-size "18px"}} "\\(f(x) = \\sqrt x\\), 18px"] [p {:style {:font-size "20px"}} "\\(ax^2 + bx + c = 0\\), 20px"]]]]}, :vid :bc1, :session-name "Exploring", :opts {:mode "vega-lite", :source false, :export {:png true, :svg true}, :renderer "canvas", :scaleFactor 1, :editor true}, :msgop :tabs, :tab {:label "Expl1", :id :expl1, :opts {:eltsper 2, :size "auto", :order :row}}, :slider [[gap :size "10px"] [label :label "Add Bar"] [label :label "-10"] [slider :model :m1 :min 246 :max 10 :step 1 :width "200px" :on-change :oc1] [label :label "+10"] [input-text :model :m1 :width "60px" :height "26px" :on-change :oc2]]}, :mark {:type "bar"}, :width 350, :background "floralwhite", :height 300, :data {:values [{:b 28, :a "A"} {:b 55, :a "B"} {:b 43, :a "C"} {:b 91, :a "D"} {:b 81, :a "E"} {:b 53, :a "F"} {:b 19, :a "G"} {:b 87, :a "H"} {:b 52, :a "I"}]}}]}}]
